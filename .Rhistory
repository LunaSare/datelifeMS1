target_tree = otol)
usethis::use_data(phy_median, overwrite = TRUE)
ltt_summ = datelifeplot::plot_ltt_summary(taxon = "Fringillidae", phy = phyloall, phy_sdm, phy_median,
file_name = "ltt_summ_poster.pdf", file_dir = "~//Desktop//datelife_paper1//", height = 3, width = 7.9,
add_legend = TRUE)
usethis::use_data(ltt_sum, overwrite = TRUE)
ltt_summ
each_calibrations = datelife::get_all_calibrations(phyloall, each = TRUE)
usethis::use_data(each_calibrations, overwrite = TRUE)
getwd()
library("papaja")
r_refs("paper_references.bib")
dq <- datelife::make_datelife_query(input = "fringillidae")
dq
?make_datelife_query
dq <- datelife::make_datelife_query(input = "fringillidae", get_spp_from_taxon = TRUE)
?sys.Date
??sys.Date
Sys.Date()
format(Sys.Date(), format="%B %d %Y")
load(dq)
data(dq)
load("~/pj_datelife/datelifeMS1/data/dq.rda")
load("data/dq.rda")
getwd()
getwd()
load("../data/dq.rda")
load("../data/dr.rda")
data(opentree_chronograms, package = "datelife")
1499/20
5/16
1/4
5/8
utils::data("opentree_chronograms", package = "datelife")
dq = datelife::make_datelife_query(input = "fringilidae", get_spp_from_taxon = TRUE)
args(summary)
methods(summary)
summary.phylo
ape::summary.phylo
ls()
?ape::summary.phylo
?base::summary
stats::summary.lm
utils::data("opentree_chronograms", package = "datelife")
dquery = datelife::make_datelife_query(input = "fringilidae", get_spp_from_taxon = TRUE)
usethis::use_data(dquery, overwrite = TRUE)
dres = datelife::get_datelife_result(input = dq, cache = opentree_chronograms)
dres = datelife::get_datelife_result(input = dquery, cache = opentree_chronograms)
dsumm = datelife::summary(datelife_query = dquery, datelife_result = dres)
dsumm = datelife::summary(datelife_query = dquery, object = dres)
library(datelife)
?summary.datelifeResult
utils::data("opentree_chronograms", package = "datelife")
dquery = datelife::make_datelife_query(input = "fringilidae", get_spp_from_taxon = TRUE)
dres = datelife::get_datelife_result(input = dquery, cache = opentree_chronograms)
dsumm = datelife::summary(datelife_query = dquery, object = dres)
dsumm = summary(datelife_query = dquery, object = dres)
usethis::use_data(dsumm, overwrite = TRUE)
devtools::document()
usethis::use_data(dres, overwrite = TRUE)
devtools::document()
devtools::document()
?extract_calibrations_phylo
calibs <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all, each = FALSE)
str(calibs)
length(calibs)
class(calibs)
names(calibs)
nrow(calibs)
calibs_each <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = TRUE)
length(calibs_each)
class(calibs_each)
names(calibs_each)
nrow(calibs_each)
sapply(calibs_each, nrow)
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
length(calibs_all)
class(calibs_all)
names(calibs_all)
nrow(calibs_all)
summ(sapply(calibs_each, nrow))
sum(sapply(calibs_each, nrow))
dsumm$phylo_median
dsumm$phylo_sdm
dsumm$phylo_biggest
dsumm$data_frame
names(dsumm$data_frame)
dsumm$data_frame$Ntax
dquery$cleaned_names
dsumm$phylo_median
rotl::tnrs_match_names("fringillidae")
rotl::tol_subtree(ott_id = 839319)
rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids)
ot
rotl::is_in_tree(ott_ids = 839319)
?match_all_calibrations
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
ot$tip.label
rotl::tol_induced_subtree
?rotl::tol_induced_subtree()
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
matched
class(matched)
names(matched)
matched$matched_calibrations
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
nrow(matched$present_calibrations)
nrow(calibs_all)
names(matched$present_calibrations)
write.csv(matched$matched_calibrations, file = "data-raw/fringillidae-matched-calibrations.csv")
matched$matched_calibrations[58,]
matched$matched_calibrations["58",]
"5e34a632bf6fe8c2400e7a20efe22e98" %in% matched$present_calibrations$MRCA
"5e34a632bf6fe8c2400e7a20efe22e98" == matched$present_calibrations$MRCA
which("5e34a632bf6fe8c2400e7a20efe22e98" == matched$present_calibrations$MRCA)
unique(matched$matched_calibrations$reference)
unique(matched$present_calibrations$reference)
names(calibs_all)
unique(calibs_all$reference)
length(dsumm$phylo_all)
unique(matched$present_calibrations$taxonA)
match(unique(matched$present_calibrations$taxonA), matched$matched_calibrations$taxonA)
match(unique(matched$present_calibrations$taxonA), ot$tip.label)
unique(matched$present_calibrations$taxonB) #214
length(unique(matched$present_calibrations$taxonA)) #214
length(unique(matched$matched_calibrations$taxonA))
length(unique(matched$matched_calibrations$taxonB)) # 141
dquery$cleaned_names
dsumm$phylo_median
usethis::use_vignette(name = "node-age-comparison")
library(datelifeMS1)
ot
ls(matched)
matched$phy
write.csv(matched$matched_calibrations, file = "data-raw/fringillidae-present-calibrations.csv")
write.csv(matched$present_calibrations, file = "data-raw/fringillidae-present-calibrations.csv")
?write.csv
write.csv(matched$present_calibrations, file = "data-raw/fringillidae-present-calibrations.csv", append = FALSE)
write.csv(matched$matched_calibrations, file = "data-raw/fringillidae-matched-calibrations.csv")
write.csv(matched$present_calibrations, file = "../data-raw/fringillidae-present-calibrations.csv")
plot(matched$matched_calibrations$NodeNames, matched$matched_calibrations$MinAge)
matched$matched_calibrations$MinAge
matched$matched_calibrations$NodeNames
?gsub
y_axis <- as.numeric(gsub("n", "", matched$matched_calibrations$NodeNames))
y_axis
as.numeric(matched$matched_calibrations$MinAge)
matched$matched_calibrations$MinAge
class(matched$matched_calibrations$MinAge)
plot(matched$matched_calibrations$MinAge, y_axis)
-matched$matched_calibrations$MinAge
plot(-matched$matched_calibrations$MinAge, y_axis, x_label = "Time (myrs)", y_label = "node")
plot(-matched$matched_calibrations$MinAge, y_axis, x.label = "Time (myrs)", y.label = "node")
?plot
plot(-matched$matched_calibrations$MinAge, y_axis, xlab = "Time (myrs)", ylab = "node")
plot(-matched$matched_calibrations$MinAge, y_axis, xlab = "Time (myrs)", ylab = "node", pch = 20)
plot(-matched$matched_calibrations$MinAge, y_axis, xlab = "Time (myrs)", ylab = "node", pch = 20, col = "gray")
my_data <- data.frame(node = y_axis, age = -matched$matched_calibrations$MinAge, study = matched$matched_calibrations$reference)
my_data
class(my_data$reference)
my_data <- data.frame(node = y_axis, age = -matched$matched_calibrations$MinAge, study = factor(matched$matched_calibrations$reference))
head(my_data)
class(my_data$reference)
class(my_data$study)
my_data <- data.frame(node = y_axis, age = -matched$matched_calibrations$MinAge, study = matched$matched_calibrations$reference)
class(my_data$study)
my_data <- data.frame(node = y_axis, age = -matched$matched_calibrations$MinAge, study = factor(matched$matched_calibrations$reference))
plot(my_data)
plot(my_data$age, my_data$node, xlab = "Time (myrs)", ylab = "node", pch = 20, col = my_colors)
?data
plot(my_data$age, my_data$node, xlab = "Time (myrs)", ylab = "node", pch = 20, col = my_data$study)
?datelife::match_all_calibrations
?datelife::match_all_calibrations
install.packages("datelife")
library(datelife)
package_version(datelife)
package_version("datelife")
packageVersion("datelife")
devtools::install_github("phylotastic/datelife")
packageVersion("datelife")
?datelife::match_all_calibrations
utils::data("opentree_chronograms", package = "datelife")
library(datelifeMS1)
phy$calibration_distribution
ot$calibration_distribution
devtools::load_all()
devtools::load_all(datelifeMS1)
devtools::load_all()
data("dsumm", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
length(calibs_all)
class(calibs_all)
names(calibs_all)
nrow(calibs_all)
unique(calibs_all$reference)
calibs_each <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = TRUE)
length(calibs_each)
class(calibs_each)
names(calibs_each)
sapply(calibs_each, nrow)
sum(sapply(calibs_each, nrow))
calibs_each <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = TRUE)
length(calibs_each)
class(calibs_each)
names(calibs_each)
# sapply(calibs_each, nrow)
sum(sapply(calibs_each, nrow))
dsumm$phylo_median
dsumm$phylo_sdm
dsumm$phylo_biggest
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
rotl::tol_subtree(ott_id = "839319")
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
matched$phy$calibration_distribution
ls(matched$phy)
?summary
devtools::load_all()
data("dsumm", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
length(calibs_all)
class(calibs_all)
names(calibs_all)
nrow(calibs_all)
unique(calibs_all$reference)
calibs_each <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = TRUE)
# length(calibs_each)
# class(calibs_each)
# names(calibs_each)
# # sapply(calibs_each, nrow)
# sum(sapply(calibs_each, nrow))
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
dquery$ott_ids
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
names(matched)
devtoolss::install_github("phylotastic/datelife")
devtoolss::install_github("phylotastic/datelife")
devtools::install_github("phylotastic/datelife")
library(datelife)
devtools::load_all()
data("dquery", package = "datelifeMS1")
data("dres", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
# length(calibs_all)
# class(calibs_all)
# names(calibs_all)
# nrow(calibs_all)
# unique(calibs_all$reference)
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
matched$matched_calibrations
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
nrow(matched$present_calibrations)
names(matched$present_calibrations)
class(matched$matched_calibrations)
devtools::install_github("phylotastic/datelife")
devtools::load_all()
data("dquery", package = "datelifeMS1")
data("dres", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
# length(calibs_all)
# class(calibs_all)
# names(calibs_all)
# nrow(calibs_all)
# unique(calibs_all$reference)
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
matched$matched_calibrations
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
class(matched$matched_calibrations)
devtools::install_github("phylotastic/datelife")
devtools::install_github("phylotastic/datelife", force = TRUE)
datelife:::match_all_calibrations
data("dquery", package = "datelifeMS1")
data("dres", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
# length(calibs_all)
# class(calibs_all)
# names(calibs_all)
# nrow(calibs_all)
# unique(calibs_all$reference)
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
matched$matched_calibrations
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
class(matched$matched_calibrations)
class(matched)
devtoolss::install_github("phylotastic/datelife")
devtools::install_github("phylotastic/datelife")
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
matched$matched_calibrations
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
class(matched$matched_calibrations)
datelife:::match_all_calibrations
devtools::load_all()
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
data("dquery", package = "datelifeMS1")
data("dres", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
# length(calibs_all)
# class(calibs_all)
# names(calibs_all)
# nrow(calibs_all)
# unique(calibs_all$reference)
class(calibs_all)
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
matched$matched_calibrations
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
class(matched$matched_calibrations)
write.csv(matched$matched_calibrations, file = "../data-raw/fringillidae-matched-calibrations.csv")
csumm <- summary(matched$matched_calibrations)
names(csumm)
csumm <- datelife::summary.matchedCalibrations(matched$matched_calibrations)
csumm <- datelife:::summary.matchedCalibrations(matched$matched_calibrations)
names(csumm)
class(csumm$in_phy)
typeof(csumm$in_phy)
names(csumm$in_phy)
colnames(csumm$in_phy)
sapply(colnames(csumm$in_phy),function(i) typeof(csumm$in_phy[i]))
sapply(colnames(csumm$in_phy),function(i) class(csumm$in_phy[i]))
sapply(colnames(csumm$in_phy),function(i) is.factor(csumm$in_phy[i]))
csumm$in_phy["MinAge"]
isnumeric(csumm$in_phy["MinAge"])
is.numeric(csumm$in_phy["MinAge"])
class(csumm$in_phy["MinAge"])
class(csumm$in_phy[["MinAge"]])
sapply(colnames(csumm$in_phy),function(i) is.factor(csumm$in_phy[[i]]))
plot(csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = 20, col = csumm$in_phy$mrca_node_name)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = 20, col = csumm$in_phy$mrca_node_name)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = 20, col = csumm$in_phy$reference)
devtools::install_github("phylotastic/datelife")
devtools::install_github("phylotastic/datelife")
devtools::install_github("phylotastic/datelife")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
devtools::load_all()
data("dquery", package = "datelifeMS1")
data("dres", package = "datelifeMS1")
data("dsumm", package = "datelifeMS1")
calibs_all <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
# length(calibs_all)
class(calibs_all)
# names(calibs_all)
# nrow(calibs_all)
# unique(calibs_all$reference)
dsumm$phylo_median
dsumm$phylo_sdm
dsumm$phylo_biggest
rotl::tnrs_match_names("fringillidae")
#>   search_string  unique_name approximate_match ott_id is_synonym
#> 1  fringillidae Fringillidae             FALSE 839319      FALSE
#>   flags number_matches
#> 1                    1
rotl::is_in_tree(ott_ids = 839319)
#> [1] FALSE
# rotl::tol_subtree(ott_id = "839319")
ot <- rotl::tol_induced_subtree(ott_ids = dquery$ott_ids, label_format = "name")
ot
matched <- datelife::match_all_calibrations(phy = ot, calibrations = calibs_all)
class(matched)
names(matched)
names(matched$matched_calibrations)
nrow(matched$matched_calibrations)
class(matched$matched_calibrations)
write.csv(matched$matched_calibrations, file = "../data-raw/fringillidae-matched-calibrations.csv")
csumm <- datelife:::summary.matchedCalibrations(matched$matched_calibrations)
names(csumm)
nrow(csumm$not_in_phy)
sapply(colnames(csumm$in_phy),function(i) is.factor(csumm$in_phy[[i]]))
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = 20, col = csumm$in_phy$mrca_node_name)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = 20, col = csumm$in_phy$reference)
matched$phy$calibration_distribution
ls(matched$phy)
?plot
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = csumm$in_phy$mrca_node_number, col = csumm$in_phy$reference)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = csumm$in_phy$mrca_node_number-289, col = csumm$in_phy$reference)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = as.character(csumm$in_phy$mrca_node_number-289), col = csumm$in_phy$reference)
as.character(csumm$in_phy$mrca_node_number-289)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = as.character(csumm$in_phy$mrca_node_number-289), col = csumm$in_phy$reference)
plot(-csumm$in_phy$MaxAge, csumm$in_phy$mrca_node_number, xlab = "Time (myrs)", ylab = "Node Number", pch = 0:25, col = csumm$in_phy$reference)
plot(-csumm$in_phy$MaxAge[1:89], csumm$in_phy$mrca_node_number[1:89], xlab = "Time (myrs)", ylab = "Node Number", pch = as.character(csumm$in_phy$mrca_node_number-289[1:89]), col = csumm$in_phy$reference[1:89])
plot(-csumm$in_phy$MaxAge[1:89], csumm$in_phy$mrca_node_number[1:89], xlab = "Time (myrs)", ylab = "Node Number", pch = as.character((csumm$in_phy$mrca_node_number-289)[1:89]), col = csumm$in_phy$reference[1:89])
as.character((csumm$in_phy$mrca_node_number-289)[1:89])
plot(-csumm$in_phy$MaxAge[1:89], csumm$in_phy$mrca_node_number[1:89], xlab = "Time (myrs)", ylab = "Node Number", pch = as.character((csumm$in_phy$mrca_node_number-289)[1:89]), col = csumm$in_phy$reference[1:89])
plot(-csumm$in_phy$MaxAge[1:85], csumm$in_phy$mrca_node_number[1:85], xlab = "Time (myrs)", ylab = "Node Number", pch = as.character((csumm$in_phy$mrca_node_number-289)[1:85]), col = csumm$in_phy$reference[1:85])
csumm$in_phy$reference[1:85]
plot(-csumm$in_phy$MaxAge[1:85], csumm$in_phy$mrca_node_number[1:85], xlab = "Time (myrs)", ylab = "Node Number", pch = as.character((csumm$in_phy$mrca_node_number-289)[1:85]), col = csumm$in_phy$reference[1:85])
devtools::document()
length(calibs_all)
names(calibs_all)
dsumm$phylo_all
class(calibs_all)
all_calibrations <- datelife::extract_calibrations_phylo(input = dsumm$phylo_all,
each = FALSE)
nrow(all_calibrations)
dsumm$phylo_all
names(dsumm$phylo_all)
duplicated(names(dsumm$phylo_all))
?duplicated
names(dsumm$phylo_all)[duplicated(names(dsumm$phylo_all))]
class(dsumm$phylo_all)
length(dquery$cleaned_names)
length(all_calibrations$MRCA)
length(unique(all_calibrations$MRCA))
1124-1083
<!--
```{r}
length(all_calibrations$MRCA)
length(unique(all_calibrations$MRCA))
all_calibrations$MRCA[duplicated(all_calibrations$MRCA)]
